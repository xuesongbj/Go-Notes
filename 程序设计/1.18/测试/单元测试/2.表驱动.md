# 表驱动

表驱动(table driven)将数据和逻辑分离，便于维护和扩展。

&nbsp;

* 子测试，确保所有数据被测试。(不会因错误中断)
* 并行子测试，提高效率。

&nbsp;

* 建议使用相同命名，规范化。(让维护数据的人更易懂)
* 使用短名`wangt/got` 要比 `expected/actual` 易懂。
* 输出信息应该面向自然阅读。

&nbsp;

```go
func add(a, b int) int {
    return a + b
}

func TestAdd(t *testing.T) {
        var tests = []struct {
                x int
                y int
                want int
        }{
                {1, 2, 3},
                {2, 2, 6},
                {3, 2, 5},
        }

        for _, tt := range tests {
                o := tt

                t.Run("", func(t *testing.T) {
                        t.Parallel()

                        got := add(o.x, o.y)
                        if got != o.want {
                                t.Errorf("add(%d, %d): want %d, got %d", o.x, o.y, o.want, got)
                        }
                })
        }
}
```

&nbsp;

```go
root@8d75790f92f5:~/go/david# go test -run "Add"
--- FAIL: TestAdd (0.00s)
    --- FAIL: TestAdd/#01 (0.00s)
        main_test.go:28: add(2, 2): want 6, got 4
FAIL
exit status 1
FAIL    david   0.004s
```
