# 版本，变更记录

[Release History, go.dev](https://go.dev/doc/devel/release)

## 1.19

* 增加 `//go:build unix` 支持。
* 改善 switch 性能。

* 运行时内存限制(soft memory limit)。
* 自动将文件限制(open file limit) 调整至最大值(hard limit)。
* 竞争检查(race detector, thread sanitizer) 升级到v3。

&nbsp;

* 新增 `sync/atomic.Int32` 等类型原子版本。

&nbsp;

## 1.18

* <font color="#666600">泛型支持。(尚不完善)</font>
* 模糊测试。(Fuzzing)

&nbsp;

* `go work` 对<font color="#666600">工作空间</font>(workspace)支持。
* `go get` 专注于依赖管理，不再构建(build)和安装(install)包。

&nbsp;

* 垃圾回收器支持非堆(noheap)内存。
* 可内联包含循环的函数。

&nbsp;

* 新增 `debug/buildinfo`。
* 新增 `net/netip`。

&nbsp;

## 1.17

* 直接从切片转换为数组指针。
* 新增 `unsafe.Add` 和 `unsafe.Slice` 简化操作。

&nbsp;

* 模块获取 `-insecure` 参数被移除，以 `GOINSECURE` 代替。
* 如模块缺失 `go version` 指令，则使用 1.11/1.16 版本。
* 以 `//go:build` 替代 `// +build`。

&nbsp;

* <font color="#666600">编译器实现了以寄存器传递参数</font>。
* 改进错误信息中的调用堆栈信息。
* 可内联含闭包的函数。

&nbsp;

## 1.16

* 单元测试调用 `os.Exit(0)` 视为失败。

&nbsp;

* <font color="#666600">无论是否有 go.mod，模块感知都为默认模式。</font>
* 编译命令(go build, go test) 不再修改go.mod，使用 `go get` 和 `go mod tidy`。
* 安装命令(`go install`)支持版本号。
* 下载命令(`go get`)不再使用 insecure 非安全方式。

&nbsp;

* 调试`GODEBUG=inittrace=1` 输出初始化函数执行信息。
* 使用`MADV_DONTNEED`代替`MADV_FREE`，立即释放物理内存。

&nbsp;

* 新增 `//go:embed` 向目标文件嵌入静态文件(文件树)。
* 新增 `runtime/metrics`，替代 `runtime.ReadMemStats`。
* 弃用 `io/ioutil`。

&nbsp;

## 1.15

* `GOPROXY` 支持逗号和竖线分隔(逗号仅在 404、410时尝试下一代理)。
* `GOMODCACHE`设置模块缓存位置，默认 `GOPATH[0]/pkg/mod`。

&nbsp;

* 预置小整数表(0~255)。转换为接口时，不再分配额外内存。
* 链接器重大改进。

&nbsp;

## 1.14

* <font color="#666600">嵌入重叠接口。(方法集是所有嵌入声明的并集)</font>

&nbsp;

* 模块可用于生产环境。
* 环境变量 `GOINSECURE` 指示某些源不使用HTTPS，跳过证书验证。

&nbsp;

* 内联调用defer函数(inline call)，提升性能。
* <font color="#666600">基于信号(signal)的异步抢占调度。</font>
* 内存分配器延迟更小，吞吐量更高。
* 重新设计的内部定时器(internal timer) 更高效。

&nbsp;

* 新增 `hash/maphash`。
* 增加 `testing.T.CleanUp`。

> macOS平台约定，二进制内Go符号以下划线开头。

&nbsp;

## 1.13

* 增加二进制(Ob)、八进制(0o)整数字面量。
* 增加十六进制浮点字面量。
* 增加虚数字面量。
* 使用下划线作为数字分隔符(000_111_222)。
* 移除位移数(shift count)必须是无符号整数(unsigned)限制。

&nbsp;

* 模块感知`GO111MODULE`默认开启。
* 模块相关环境变量: `GOPRIVATE`、`GOPROXY`、`GOSUMDB`。

&nbsp;

* 提升`defer`性能。（deferprocStack）
* 更积极归还物理内存。(bgscavenge)

&nbsp;

## 1.12

* 改写 `go vet`，不在支持 `go tool vet`。
* 编译缓存必须，不能用 `GOCACHE=off` 关闭。
* 最后一个支持`//go:binary-only-package`的版本。

&nbsp;

* 改进存活变量分析，更快执行 `Finalizer` 操作。
* 支持更多函数内联。建议用 `runtime.CallersFrames` 代替 `Callers`。
* 支持 `-lang` 参数指定语言版本，用于检查新增语法兼容问题。
* 使用不同调用约定处理Go和ASM函数。
* 提升 DWARF 调试信息。
* 改进 trace 跟踪信息。

&nbsp;

* 提升垃圾清理性能，减少分配延时。
* 更积极向操作系统归还内存。
* 改用 `MADV_FEEE` 释放物理内存。

&nbsp;

* 函数 `runtime.Caller` 等不再包含编译器自动生成的初始化函数。
* 标准库 `crypto/tls` 支持 TLS 1.3。

&nbsp;

> Darwin syscall 使用 libSystem，确保兼容macOS 和 ios。

&nbsp;

## 1.11

* 在 `type.switch` 里的未使用变量视为错误。

* 实验性支持 WebAssembly。
* 实验性启用依赖管理Modules，替代 GOPATH。
* 实现性支持在调试器(delve)中调用函数(cell)。
* 最后一个支持`GOCACHE=off`的版本。

&nbsp;

* 编译器支持内联更多类型函数，包括调用 `panic` 的函数。
* 编译优化 map delete、slice append。
* 更准确的调试信息，对没有 `-N -l` 编译结果提供更好的支持。
* 单元测试默认调用 `go vet` 进行检查。
* 最后一个支持 `godoc` 命令行的版本，未来基于web。

&nbsp;

* <font color="#666600"> 内存分配器使用稀疏堆，不再有512GB限制。</font>

&nbsp;

> 符号 @ 在module中有特殊含义，命令行不再支持@符号。

&nbsp;

## 1.10

* 使用 `GOCACHE` 缓存编译结果。
* 单元测试(go test) 也将使用缓存加速。
* 性能测试(to tool pprof) 新增 WEB 界面。

&nbsp;

* 堆栈跟踪(stack trace) 不再包含编译器自动生成(autogenerated) 函数。
* <font color="#666600"> GOMAXPROCS最大限制取消 </font>。
* `LockOSThread`/`UnlockOSThread` 嵌套数量必须匹配。

&nbsp;

## 1.9

* <font color="#666600"> 类型别名 </font>。(`type Alias = Name`)

&nbsp;

* 并行编译。(`GO19CONCURRENTCOMPILATION=0` 禁用)
* 工具集默认不再扫描 `vendor` 目录。
* 安装目录不再固定。(可显示设置 `TOROOT`)

&nbsp;

* 新增 `sync/map`。
* 新增 test helper。
* 新增 pprof profile。

&nbsp;

## 1.8

* <font color="#666600"> 不同的 tag 不再阻止 struct 显式转换</font>。

&nbsp;

* 改善 `map` 并发操作检测。
* 垃圾回收暂停时间进一步缩短到(10 ~ 100us)。
* 函数参数生命周期不再等同整个栈帧，可提前回收，用 `KeepAlive` 保持。
* 改进 `defer`、CGO调用开销(一半)。

&nbsp;

* <font color="#666600"> 编译后端SSA支持所有平台</font>。
* 默认 `GOPATH` 设置 `$HOME/go`。
* 插件模式(buildmode: `plugin`)。
* 支持mutex profile。

&nbsp;

* HTTP2/push，HTTP Server Graceful Shutdown。

&nbsp;

## 1.7

* 新二进制格式。

&nbsp;

* AMD64使用SSA后端。
* 包依赖 `vendor` 成为正式功能。
* 增加对Linux's perf、Intel's VTune 工具支持(设置并保存BP寄存器值)。
* 实验性支持 binary-only package。(静态包，不再需要源码文件)

&nbsp;

> BP寄存器可选：在make.bash 构建工具链添加 `GOEXPERIMENT=noframepointer` 屏蔽。

&nbsp;

## 1.6

* CGO支持指针共享。

&nbsp;

* 重写 `parser`，替代 `yacc` 生成。
* 增加 `buildmode` `c-shared` 支持。

&nbsp;

* <font color="#666600"> HTTP2 支持。</font>

&nbsp;

## 1.5

* 自举：用Go重写运行时和编译器，需要使用Go编译Go。

&nbsp;

* 重命名 `6g`、`6l`，改为 `compile`、`linker`、`asm`。
* 环境变量 `GOMAXPROCS` 默认 `cores` 数量。
* 增加 `buildmode` 支持，生成共享库。

&nbsp;

* 支持 `internal`、`vendor` 包。
* 支持 `go tool trace` 命令，跟踪执行过程。
